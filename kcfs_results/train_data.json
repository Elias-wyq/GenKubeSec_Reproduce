[
  {
    "instruction": "You are a Kubernetes security expert. Detect misconfigurations in the following Kubernetes manifest. Return the detected issues as a list of encoded labels in the format 'ResourceName+UMI_ID'.",
    "input": "# permissions for end users to view configs.\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: config-viewer-role\nrules:\n- apiGroups:\n  - machine.crit.sh\n  resources:\n  - configs\n  verbs:\n  - get\n  - list\n  - watch\n- apiGroups:\n  - machine.crit.sh\n  resources:\n  - configs/status\n  verbs:\n  - get\n",
    "output": "safe"
  },
  {
    "instruction": "You are a Kubernetes security expert. Detect misconfigurations in the following Kubernetes manifest. Return the detected issues as a list of encoded labels in the format 'ResourceName+UMI_ID'.",
    "input": "apiVersion: v1\nkind: Service\nmetadata:\n  name: argocd-metrics\nspec:\n  ports:\n  - name: http\n    protocol: TCP\n    port: 8082\n    targetPort: 8082\n  selector:\n    app: argocd-server\n",
    "output": "argocd-metrics+122, argocd-metrics+18"
  },
  {
    "instruction": "You are a Kubernetes security expert. Detect misconfigurations in the following Kubernetes manifest. Return the detected issues as a list of encoded labels in the format 'ResourceName+UMI_ID'.",
    "input": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: boskos-metrics\n  labels:\n    app.kubernetes.io/part-of: boskos\n    app: boskos-metrics\n  namespace: boskos\nspec:\n  selector:\n    matchLabels:\n      app: boskos-metrics\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: boskos-metrics\n      namespace: test-pods\n    spec:\n      terminationGracePeriodSeconds: 30\n      containers:\n      - name: metrics\n        image: gcr.io/k8s-staging-boskos/metrics:v20200819-984516e\n        args:\n        - --resource-type=gke-perf-preset,gcp-perf-test-project,gcp-project,gke-e2e-test\n        ports:\n        - containerPort: 8080\n          protocol: TCP\n        readinessProbe:\n          httpGet:\n            path: /prometheus\n            port: 8080\n          periodSeconds: 1\n          timeoutSeconds: 1\n          successThreshold: 1\n          failureThreshold: 10\n      tolerations:\n      - key: dedicated\n        operator: Equal\n        value: boskos\n        effect: NoSchedule\n      nodeSelector:\n        prod: boskos\n",
    "output": "boskos-metrics+10, boskos-metrics+11, boskos-metrics+114, boskos-metrics+13, boskos-metrics+14, boskos-metrics+15, boskos-metrics+16, boskos-metrics+162, boskos-metrics+19, boskos-metrics+27, boskos-metrics+29, boskos-metrics+30, boskos-metrics+32, boskos-metrics+33, boskos-metrics+34, boskos-metrics+35, boskos-metrics+4, boskos-metrics+43, boskos-metrics+50, boskos-metrics+7, boskos-metrics+8"
  },
  {
    "instruction": "You are a Kubernetes security expert. Detect misconfigurations in the following Kubernetes manifest. Return the detected issues as a list of encoded labels in the format 'ResourceName+UMI_ID'.",
    "input": "# Copyright 2016 The Kubernetes Authors All rights reserved.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#     http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: statusreconciler\n  labels:\n    app: statusreconciler\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: statusreconciler\n  template:\n    metadata:\n      labels:\n        app: statusreconciler\n    spec:\n      serviceAccountName: statusreconciler\n      terminationGracePeriodSeconds: 180\n      containers:\n      - name: statusreconciler\n        image: gcr.io/k8s-prow/status-reconciler:v20210414-378dc3ffc3\n        imagePullPolicy: Always\n        args:\n        - --dry-run=false\n        - --continue-on-error=true\n        - --plugin-config=/etc/plugins/plugins.yaml\n        - --config-path=/etc/config/config.yaml\n        - --github-token-path=/etc/github/oauth\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --job-config-path=/etc/job-config\n        - --denylist=kubernetes/kubernetes\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n      volumes:\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "output": "statusreconciler+10, statusreconciler+11, statusreconciler+114, statusreconciler+12, statusreconciler+13, statusreconciler+139, statusreconciler+14, statusreconciler+15, statusreconciler+16, statusreconciler+162, statusreconciler+18, statusreconciler+19, statusreconciler+27, statusreconciler+29, statusreconciler+30, statusreconciler+32, statusreconciler+33, statusreconciler+34, statusreconciler+35, statusreconciler+4, statusreconciler+50, statusreconciler+7, statusreconciler+8"
  },
  {
    "instruction": "You are a Kubernetes security expert. Detect misconfigurations in the following Kubernetes manifest. Return the detected issues as a list of encoded labels in the format 'ResourceName+UMI_ID'.",
    "input": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: drupal\n    appMajor: \"8\"\n    instance: datasets.lib.unb.ca\n    tier: frontend\n    uri: datasets.lib.unb.ca\n    vcsOwner: unb-libraries\n    vcsRepository: datasets.lib.unb.ca\n    vcsRef: prod\n  name: datasets-lib-unb-ca\n  namespace: prod\nspec:\n  selector:\n    matchLabels:\n      uri: datasets.lib.unb.ca\n  replicas: 1\n  revisionHistoryLimit: 2\n  minReadySeconds: 30\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxSurge: 1\n      maxUnavailable: 0\n  template:\n    metadata:\n      labels:\n        app: drupal\n        appMajor: \"8\"\n        instance: datasets.lib.unb.ca\n        tier: frontend\n        uri: datasets.lib.unb.ca\n        vcsOwner: unb-libraries\n        vcsRepository: datasets.lib.unb.ca\n        vcsRef: prod\n    spec:\n      nodeSelector:\n        deployenv: prod\n      containers:\n        -\n          name: datasets-lib-unb-ca\n          readinessProbe:\n            httpGet:\n              path: /health\n              port: 80\n            initialDelaySeconds: 30\n            timeoutSeconds: 3\n            periodSeconds: 15\n          livenessProbe:\n            httpGet:\n              path: /health\n              port: 80\n            initialDelaySeconds: 100\n            timeoutSeconds: 3\n            periodSeconds: 15\n          env:\n            -\n              name: DEPLOY_ENV\n              value: prod\n            -\n              name: MYSQL_HOSTNAME\n              value: drupal-mysql-lib-unb-ca\n            -\n              name: MYSQL_PORT\n              value: \"3306\"\n            -\n              name: MYSQL_ROOT_PASSWORD\n              valueFrom:\n                secretKeyRef:\n                  name: mysql\n                  key: root-password\n            -\n              name: NR_INSTALL_KEY\n              valueFrom:\n                secretKeyRef:\n                  name: newrelic\n                  key: install-key\n          image: \"||DEPLOYMENTIMAGE||\"\n          imagePullPolicy: Always\n          ports:\n            -\n              containerPort: 80\n          volumeMounts:\n            -\n              mountPath: /app/html/sites/default\n              name: drupal-persistent-storage\n      priorityClassName: med-priority-services\n      imagePullSecrets:\n        -\n          name: github-container-registry-auth\n      restartPolicy: Always\n      volumes:\n        -\n          name: drupal-persistent-storage\n          persistentVolumeClaim:\n            claimName: datasets-lib-unb-ca\n",
    "output": "datasets-lib-unb-ca+10, datasets-lib-unb-ca+114, datasets-lib-unb-ca+12, datasets-lib-unb-ca+13, datasets-lib-unb-ca+14, datasets-lib-unb-ca+15, datasets-lib-unb-ca+16, datasets-lib-unb-ca+162, datasets-lib-unb-ca+17, datasets-lib-unb-ca+19, datasets-lib-unb-ca+21, datasets-lib-unb-ca+27, datasets-lib-unb-ca+29, datasets-lib-unb-ca+30, datasets-lib-unb-ca+32, datasets-lib-unb-ca+33, datasets-lib-unb-ca+34, datasets-lib-unb-ca+35, datasets-lib-unb-ca+4, datasets-lib-unb-ca+50, datasets-lib-unb-ca+7, datasets-lib-unb-ca+8"
  },
  {
    "instruction": "You are a Kubernetes security expert. Detect misconfigurations in the following Kubernetes manifest. Return the detected issues as a list of encoded labels in the format 'ResourceName+UMI_ID'.",
    "input": "apiVersion: v1\nkind: Service\nmetadata:\n  name: open-api-doc\nspec:\n  type: ClusterIP\n  ports:\n  - port: 80\n    targetPort: 80\n    protocol: TCP\n    name: http\n  selector:\n    app: open-api-doc",
    "output": "open-api-doc+122, open-api-doc+18"
  },
  {
    "instruction": "You are a Kubernetes security expert. Detect misconfigurations in the following Kubernetes manifest. Return the detected issues as a list of encoded labels in the format 'ResourceName+UMI_ID'.",
    "input": "#\n# Licensed to the Apache Software Foundation (ASF) under one\n# or more contributor license agreements.  See the NOTICE file\n# distributed with this work for additional information\n# regarding copyright ownership.  The ASF licenses this file\n# to you under the Apache License, Version 2.0 (the\n# \"License\"); you may not use this file except in compliance\n# with the License.  You may obtain a copy of the License at\n#\n#   http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing,\n# software distributed under the License is distributed on an\n# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n# KIND, either express or implied.  See the License for the\n# specific language governing permissions and limitations\n# under the License.\n#\n\napiVersion: v1\nkind: Pod\nmetadata:\n    name: pulsar-admin\nspec:\n    containers:\n      - name: pulsar-admin\n        image: apachepulsar/pulsar:latest\n        command: [\"sh\", \"-c\"]\n        args:\n          - >\n            bin/apply-config-from-env.py conf/client.conf &&\n            bin/apply-config-from-env.py conf/pulsar_env.sh &&\n            bin/apply-config-from-env.py conf/pulsar_tools_env.sh &&\n            sleep 10000000000\n        envFrom:\n          - configMapRef:\n                name: broker-config\n        env:\n          - name: webServiceUrl\n            value: \"http://broker:8080/\"\n          - name: brokerServiceUrl\n            value: \"pulsar://broker:6650/\"\n          - name: PULSAR_MEM\n            value: \"\\\"-Xms64m -Xmx128m\\\"\"\n",
    "output": "pulsar-admin+10, pulsar-admin+11, pulsar-admin+114, pulsar-admin+12, pulsar-admin+13, pulsar-admin+14, pulsar-admin+15, pulsar-admin+16, pulsar-admin+162, pulsar-admin+17, pulsar-admin+18, pulsar-admin+19, pulsar-admin+27, pulsar-admin+29, pulsar-admin+30, pulsar-admin+32, pulsar-admin+33, pulsar-admin+34, pulsar-admin+35, pulsar-admin+4, pulsar-admin+50, pulsar-admin+7, pulsar-admin+8"
  },
  {
    "instruction": "You are a Kubernetes security expert. Detect misconfigurations in the following Kubernetes manifest. Return the detected issues as a list of encoded labels in the format 'ResourceName+UMI_ID'.",
    "input": "apiVersion: v1\nkind: Service\nmetadata:\n    name: \"kubwz0un1-cffc\"\n    labels:\n        app: \"kubwz0un1-cffc\"\nspec:\n    type: LoadBalancer\n    ports:\n    - port: 8080\n      targetPort: 8080\n      protocol: TCP\n      name: http\n    selector:\n        app: \"kubwz0un1-cffc\"",
    "output": "kubwz0un1-cffc+18, kubwz0un1-cffc+22"
  },
  {
    "instruction": "You are a Kubernetes security expert. Detect misconfigurations in the following Kubernetes manifest. Return the detected issues as a list of encoded labels in the format 'ResourceName+UMI_ID'.",
    "input": "apiVersion: v1\nkind: ServiceAccount\nmetadata:\n  labels:\n    app.kubernetes.io/instance: flux-system\n    app.kubernetes.io/part-of: flux\n    app.kubernetes.io/version: 0.15.3\n  name: notification-controller\n",
    "output": "notification-controller+18"
  }
]